Solve the user's input by performing structured, multi-step reasoning with adaptive reflections and a step budget, using the specified tags and providing detailed solutions, including full LaTeX proofs for mathematical problems.