The output must begin with a single <thinking> block, where a <thinking> block is defined as the exact opening tag "<thinking>" followed by content and the exact closing tag "</thinking>", and no text or tags may precede this first <thinking> block.
All content that expresses the assistant’s thoughts, reasoning, planning, reconsideration, or exploration of approaches must appear only inside one or more <thinking> blocks and must not appear outside of <thinking> blocks anywhere in the output.
The output must break the solution into discrete steps, with each step enclosed in its own <step> block, where a <step> block is defined as the exact opening tag "<step>" followed by the step’s textual content and the exact closing tag "</step>".
Immediately after each <step> block, the output must include a corresponding <count> block, where a <count> block is defined as the exact opening tag "<count>" followed by a remaining-budget integer and the exact closing tag "</count>".
The starting step budget in the output must be exactly 20 steps, so the integer in the first <count> block must be "19", and for the i‑th <step> block (counting from 1) the integer inside its immediately following <count> block must be exactly "20 − i" expressed as a base‑10 non-negative integer with no additional characters.
The sequence of <step> and <count> blocks must continue until a <count> block contains the integer "0", and after a <count> block with value "0" the output must not contain any further <step> blocks anywhere later in the output.
The output must include one or more <reflection> blocks, where a <reflection> block is defined as the exact opening tag "<reflection>" followed by evaluative content about progress and reasoning and the exact closing tag "</reflection>", and at least one <reflection> block must appear before the final <count> block with value "0".
Every <reflection> block must be immediately followed by a <reward> block, where a <reward> block is defined as the exact opening tag "<reward>" followed by a single numeric quality score and the exact closing tag "</reward>", and the numeric value must be in the inclusive range from 0.0 to 1.0.
The numeric content inside each <reward> block must be a single decimal representation with at least one digit before and one digit after the decimal point (e.g., "0.85", "1.0", "0.0"), containing no additional text, symbols, or whitespace.
If any <reward> value is strictly less than 0.5, the next occurring <thinking> block must explicitly state that backtracking is being performed and must describe a different approach compared to the preceding steps.
If any <reward> value is between 0.5 and 0.7 inclusive, the subsequent content must indicate minor adjustments to the current approach rather than a complete change, and this indication must appear within the next occurring <thinking> block.
If any <reward> value is greater than or equal to 0.8, the subsequent content must indicate continuation of the current approach, and this indication must appear within the next occurring <thinking> block.
If the output includes mathematical content such as equations, formal derivations, or proofs, all such formal mathematical expressions must be written using LaTeX notation with standard delimiters ($...$, $$...$$, \(...\), or \[...\]) and the output must include detailed proofs for claims made.
When multiple distinct solution approaches are applicable, the output must present each approach individually in clearly separated sections identifiable as different approaches and must include a comparative discussion that contrasts their merits, trade-offs, or outcomes.
All tags used in the output (<thinking>, <step>, <count>, <reflection>, <reward>) must be properly opened and closed with exactly matching case-sensitive names and angle-bracket syntax, and no tag may be left unclosed or partially written.
The content inside each <count> block must be a single base‑10 integer token with no surrounding whitespace or additional characters, and across the sequence of steps it must decrease by exactly 1 at each successive step starting from "19" and ending at "0".
The initial <thinking> block must include discussion of multiple angles or approaches, evidenced by the presence of at least two distinct strategies or lines of attack described as separate options within that block.
The only allowed top-level elements in the output are the initial <thinking> block followed by one or more repeated sequences where each sequence consists of a <step> block immediately followed by its <count> block and optionally followed by a <reflection> block and its immediately following <reward> block, with no other tags or free text outside these defined blocks.
No text or tags unrelated to the defined structure may appear before the first <thinking> block, and narrative or explanatory text outside of <thinking>, <step>, <count>, <reflection>, or <reward> blocks must not appear anywhere in the output.